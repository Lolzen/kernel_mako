--- drivers/input/input.c
+++ drivers/input/input.c
@@ -1707,6 +1707,10 @@
 		break;
 
 	case EV_ABS:
+		input_alloc_absinfo(dev);
+		if (!dev->absinfo)
+			return;
+
 		__set_bit(code, dev->absbit);
 		break;
 
