--- drivers/hv/vmbus_drv.c
+++ drivers/hv/vmbus_drv.c
@@ -466,7 +466,7 @@
 		 * will not deliver any more messages since there is
 		 * no empty slot
 		 */
-		smp_mb();
+		mb();
 
 		if (msg->header.message_flags.msg_pending) {
 			/*
